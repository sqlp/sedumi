language: shell
notifications:
  email: false
jobs:
  include:
    - os: linux
      dist: xenial # 16.04 LTS, Octave 4.0.0
      before_install:
      - sudo apt-get -y install octave liboctave-dev libopenblas-dev
      addons:
        apt:
          update: true
      script: octave --eval "cd examples; test_sedumi(1, 1);"
    - os: linux
      dist: bionic # 18.04 LTS, Octave 4.2.2
      before_install:
      - sudo apt-get -y install octave liboctave-dev libopenblas-dev
      addons:
        apt:
          update: true
      script: octave --eval "cd examples; test_sedumi(1, 1);"
    - os: osx
      before_install:
      - brew unlink python@2
      - brew install octave
      addons:
        homebrew:
          update: true
      script: octave --eval "cd examples; test_sedumi(1, 1);"
    - os: windows
      before_install: choco install octave.portable
      script:
      # export suggested in https://travis-ci.community/t/octave-fails-with-cannot-open-shared-object-file/2028/2
      - which *octave*
      - which *msys2_shell*
      - cmd.exe //C RefreshEnv.cmd & which *octave*
      - cmd.exe //C RefreshEnv.cmd & which *msys2_shell*
      - cmd.exe //C RefreshEnv.cmd & C:/tools/msys64/msys2_shell.cmd -defterm -mingw64 -no-start -full-path -here -c octave.exe
      - export shell2="cmd.exe //C RefreshEnv.cmd & C:/tools/msys64/msys2_shell.cmd -defterm -mingw64 -no-start -full-path -here -c"
      - $shell2 octave.exe
      - $shell2 octave-cli.exe
      - export shell="cmd.exe //C RefreshEnv.cmd & C:/tools/msys64/msys2_shell.cmd -defterm -mingw64 -no-start -full-path -here -c \$\* --"
      - $shell octave.exe
      - $shell octave-cli.exe --eval "cd examples; test_sedumi(1, 1);"
